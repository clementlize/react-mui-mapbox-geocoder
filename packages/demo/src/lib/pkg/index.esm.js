import e,{useRef as n,useEffect as t,useState as r,useCallback as o}from"react";import i from"lodash.omitby";import a from"lodash.isnil";import u from"react-autosuggest";import s from"autosuggest-highlight/match";import l from"autosuggest-highlight/parse";import{Fade as c,LinearProgress as p,makeStyles as g,createStyles as m,TextField as f,InputAdornment as d,Paper as h,Grid as v,IconButton as b,MenuItem as y,Typography as x}from"@material-ui/core";import C from"@material-ui/icons/Search";import E from"@material-ui/icons/Cancel";import k from"clsx";import{useDebouncedCallback as w}from"use-debounce";import S from"color-alpha";function P(){return(P=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function O(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n.indexOf(t=i[r])>=0||(o[t]=e[t]);return o}var j=function(n){var o=n.show,i=void 0!==o&&o,a=r(i),u=a[0],s=a[1];t(function(){i?l():(l.flush(),s(!1))},[i]);var l=w(function(){return s(!0)},100);return e.createElement(c,{in:u},e.createElement(p,{style:{position:"absolute",width:"100%"}}))},I=["ref","inputClasses"],F=["className"],T=g(function(e){return m({container:{flexGrow:1,position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},suggestion:{display:"block",marginBottom:0},suggestionsList:{margin:0,padding:0,listStyleType:"none"},inputContainer:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingRight:e.spacing(1),paddingLeft:e.spacing(2),backgroundColor:S(e.palette.background.paper,.9),overflow:"hidden","&:hover,&:active,&.inputContainerFocused":{backgroundColor:e.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"},grow:{flexGrow:1},shrink:{flexShrink:1},noGrow:{flexGrow:0},noShrink:{flexShrink:0}})});export default function(p){var g=p.endpoint,m=void 0===g?"https://api.mapbox.com":g,w=p.inputPlaceholder,S=void 0===w?"Search":w,N=p.showLoader,R=void 0===N||N,q=p.source,G=void 0===q?"mapbox.places":q,L=p.onSuggest,B=void 0===L?function(){}:L,U=p.focusOnMount,W=void 0!==U&&U,D=p.showInputContainer,V=void 0===D||D,H=p.inputValue,_=void 0===H?"":H,z=p.proximity,A=p.country,M=p.bbox,J=p.types,K=p.limit,Q=p.autocomplete,X=p.language,Y=p.suggestionsPaperProps,Z=p.onSelect,$=p.accessToken,ee=p.onInputFocus,ne=p.onInputBlur,te=p.inputClasses,re=p.inputTextFieldProps,oe=p.disableUnderline,ie=p.inputPaperProps,ae=r([]),ue=ae[0],se=ae[1],le=r(!1),ce=le[0],pe=le[1],ge=r(new Date),me=ge[0],fe=ge[1],de=r(_),he=de[0],ve=de[1],be=r(!1),ye=be[0],xe=be[1],Ce=T(),Ee=n(null),ke=function(e){var r=n();return t(function(){r.current=e},[e]),r.current}(he),we=o(function(){var e=(Ee.current||{}).input,n=void 0===e?null:e;n&&n.focus()},[]);t(function(){ve(_)},[_]),t(function(){W&&we()},[W,we]),t(function(){B&&B(ue)},[ue,B]);var Se=o(function(){ve(""),we()},[we]),Pe=o(function(n){var t=n.ref,r=n.inputClasses,o=O(n,I),i=null!=ie?ie:{},a=i.className,u=O(i,F),s=e.createElement(f,P({fullWidth:!0,InputProps:P({disableUnderline:oe,inputRef:t,startAdornment:e.createElement(d,{position:"start"},e.createElement(C,{color:"action"})),classes:r},o)},re));return V?e.createElement(e.Fragment,null,e.createElement(j,{show:ce&&R}),e.createElement(h,P({square:!1,elevation:1,className:k([Ce.inputContainer,{inputContainerFocused:ye},a])},u),e.createElement(v,{container:!0,alignItems:"center",spacing:1,wrap:"nowrap"},e.createElement(v,{item:!0,xs:!0,className:k(Ce.grow,Ce.noShrink)},s),e.createElement(c,{in:he.length>0,unmountOnExit:!0,mountOnEnter:!0},e.createElement(v,{item:!0,xs:!0,className:k(Ce.shrink,Ce.noGrow)},e.createElement(b,{"aria-label":"Clear Search Input",onClick:Se},e.createElement(E,null))))))):e.createElement(e.Fragment,null,s)},[oe,re,V,ce,R,Ce,ye,ie,he.length,Se]),Oe=o(function(e){xe(!0),ee&&ee(e)},[ee]),je=o(function(e){xe(!1),ne&&ne(e)},[ne]),Ie=o(function(n){var t=n.children;return e.createElement(h,P({},n.containerProps,{square:!1,elevation:4},Y),t)},[Y]),Fe=o(function(e,n,t){!e&&n&&n.features&&me<=t&&(fe(t),se(n.features.map(function(e){return{feature:e,label:e.place_name}}).filter(function(e){return e.label})),pe(!1))},[me]),Te=o(function(e){var n=e.value;pe(!0),ke===n?pe(!1):""===n?(se([]),pe(!1)):function(e,n,t,r,o,u,s,l,c,p,g,m){try{var f,d,h,v,b=new Date;Promise.resolve(function(y,x){try{var C=(f=e+"/geocoding/v5/"+n+"/"+r+".json",d=i({access_token:t,proximity:u&&2===Object.keys(u).length?u.longitude+","+u.latitude:null,bbox:l&&l.length>0?l.join(","):null,types:c,country:s,limit:p,autocomplete:g,language:m},a),h=f+"?"+(E=d,Object.keys(E).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(E[e])}).join("&")),Promise.resolve(fetch(h)).then(function(e){return v=e,Promise.resolve(v.json()).then(function(e){return o(null,e,b),{err:null,res:v,searchTime:b}})}))}catch(e){return x(e)}var E;return C&&C.then?C.then(void 0,x):C}(0,function(e){return o(e,null,b),{err:e,res:null,searchTime:b}}))}catch(e){return Promise.reject(e)}}(m,G,$,n,Fe,z,A,M,J,K,Q,X)},[M,A,m,K,X,Q,G,z,ke,Fe,J,$]),Ne=o(function(e,n){return Z&&Z(n.suggestion.feature),!1},[Z]),Re=o(function(){se([])},[]),qe=o(function(e,n){ve(n.newValue)},[]),Ge=o(function(n,t){var r=t.isHighlighted,o=s(n.label,t.query),i=l(n.label,o);return e.createElement(y,{selected:r,component:"div"},e.createElement(x,{noWrap:!0,variant:"subtitle1"},i.map(function(n,t){return n.highlight?e.createElement("span",{key:String(t),style:{fontWeight:500}},n.text):e.createElement("strong",{key:String(t),style:{fontWeight:300}},n.text)})))},[]),Le=o(function(e){return e.label},[]);return $?e.createElement(u,{ref:Ee,theme:{container:Ce.container,suggestionsContainerOpen:Ce.suggestionsContainerOpen,suggestionsList:Ce.suggestionsList,suggestion:Ce.suggestion},renderInputComponent:Pe,suggestions:ue,onSuggestionsFetchRequested:Te,onSuggestionsClearRequested:Re,onSuggestionSelected:Ne,renderSuggestionsContainer:Ie,getSuggestionValue:Le,renderSuggestion:Ge,inputProps:{placeholder:S,value:he,onChange:qe,onFocus:Oe,onBlur:je,className:te}}):null}
//# sourceMappingURL=index.esm.js.map
