import e,{useRef as t,useEffect as n,useState as o,useCallback as r}from"react";import a from"react-autosuggest";import l from"autosuggest-highlight/match";import s from"autosuggest-highlight/parse";import{Fade as i,LinearProgress as u,useTheme as c,Paper as p,alpha as g,Grid as m,IconButton as d,MenuItem as h,Typography as f,Box as b,TextField as x,InputAdornment as E}from"@mui/material";import y from"@mui/icons-material/Search";import v from"@mui/icons-material/Cancel";import{useDebouncedCallback as w}from"use-debounce";function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function k(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t.indexOf(n=a[o])>=0||(r[n]=e[n]);return r}function S(e){return null!=e}const j=({show:t=!1})=>{const[r,a]=o(t),l=w(()=>a(!0),250);return n(()=>{t?l():(l.flush(),a(!1))},[l,t]),e.createElement(i,{in:r},e.createElement(u,{style:{position:"absolute",width:"100%"}}))},I=["ref","inputClasses"],O=["onFocus"];export default({endpoint:u="https://api.mapbox.com",inputPlaceholder:w="Search",showLoader:P=!0,source:_="mapbox.places",onSuggest:F=(()=>{}),focusOnMount:T=!1,showInputContainer:$=!0,inputValue:R="",proximity:q,country:B,bbox:U,types:D,limit:G,autocomplete:V,language:W,suggestionsPaperProps:z,onSelect:H,accessToken:L,onInputFocus:A,onInputBlur:M,inputClasses:N,inputTextFieldProps:J,disableUnderline:K,inputPaperProps:Q})=>{const[X,Y]=o([]),[Z,ee]=o(!1),[te,ne]=o(new Date),[oe,re]=o(R),[ae,le]=o(!1),se=t(null),ie=function(e){const o=t();return n(()=>{o.current=e},[e]),o.current}(oe),ue=r(()=>{const{input:e=null}=se.current||{};e&&e.focus()},[]);n(()=>{re(R)},[R]),n(()=>{T&&ue()},[T,ue]),n(()=>{F&&F(X)},[X,F]);const ce=r(()=>{re(""),ue()},[ue]),pe=c(),ge=r(t=>{const{ref:n,inputClasses:o}=t,r=k(t,I),a=C({},null!=Q?Q:{}),{onFocus:l}=r,s=k(r,O);console.log(l),console.log(s);const u=()=>e.createElement(x,C({variant:"standard",fullWidth:!0,InputProps:C({disableUnderline:K,inputRef:n,startAdornment:e.createElement(E,{position:"start"},e.createElement(y,{color:"action"})),classes:o},s)},J));return $?e.createElement(e.Fragment,null,e.createElement(j,{show:Z&&P}),e.createElement(p,C({square:!1,elevation:1,sx:{paddingTop:1,paddingBottom:1,paddingRight:1,paddingLeft:2,backgroundColor:ae?pe.palette.background.paper:g(pe.palette.background.paper,.9),overflow:"hidden","&:hover,&:active":{backgroundColor:pe.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"}},a),e.createElement(m,{container:!0,alignItems:"center",spacing:1,wrap:"nowrap"},e.createElement(m,{item:!0,xs:!0,sx:{flexShrink:0,flexGrow:1}},e.createElement(u,null)),e.createElement(i,{in:oe.length>0,unmountOnExit:!0,mountOnEnter:!0},e.createElement(m,{item:!0,xs:!0,sx:{flexGrow:0,flexShrink:1}},e.createElement(d,{"aria-label":"Clear Search Input",onClick:ce,size:"large"},e.createElement(v,null))))))):e.createElement(u,null)},[K,J,$,Z,P,ae,Q,oe.length,ce,pe]),me=r(e=>{le(!0),A&&A(e)},[A]),de=r(e=>{le(!1),M&&M(e)},[M]),he=r(t=>{const{containerProps:n,children:o}=t;return e.createElement(p,C({},n,{square:!1,elevation:4},z),o)},[z]),fe=r((e,t,n)=>{!e&&t&&t.features&&te<=n&&(ne(n),Y(t.features.map(e=>({feature:e,label:e.place_name})).filter(e=>e.label)),ee(!1))},[te]),be=r(({value:e})=>{ee(!0),ie===e?ee(!1):""===e?(Y([]),ee(!1)):async function(e,t,n,o,r,a,l,s,i,u,c,p){const g=new Date;try{const d=`${e}/geocoding/v5/${t}/${o}.json`,h=C({},S(n)&&{access_token:n},S(a)&&{proximity:a&&2===Object.keys(a).length?`${a.longitude},${a.latitude}`:null},S(s)&&{bbox:s&&s.length>0?s.join(","):null},S(i)&&{types:i},S(l)&&{country:l},S(u)&&{limit:u},S(c)&&{autocomplete:c},S(p)&&{language:p}),f=`${d}?${m=h,Object.keys(m).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(m[e])).join("&")}`,b=await fetch(f);return r(null,await b.json(),g),{err:null,res:b,searchTime:g}}catch(e){return r(e,null,g),{err:e,res:null,searchTime:g}}var m}(u,_,L,e,fe,q,B,U,D,G,V,W)},[U,B,u,G,W,V,_,q,ie,fe,D,L]),xe=r((e,{suggestion:t})=>(H&&H(t.feature),!1),[H]),Ee=r(()=>{Y([])},[]),ye=r((e,{newValue:t})=>{re(t)},[]),ve=r((t,{query:n,isHighlighted:o})=>{const r=l(t.label,n),a=s(t.label,r);return e.createElement(h,{selected:o,component:"div"},e.createElement(f,{noWrap:!0,variant:"subtitle1"},a.map((t,n)=>e.createElement(f,{key:n,component:"span",variant:"inherit",sx:{fontWeight:t.highlight?500:300}},t.text))))},[]),we=r(e=>e.label,[]);return L?e.createElement(b,{sx:{"& .react-autosuggest__container":{flexGrow:1,position:"relative"},"& .react-autosuggest__suggestions-container--open":{position:"absolute",zIndex:1,marginTop:1,left:0,right:0},"& .react-autosuggest__suggestions-list":{margin:0,padding:0,listStyleType:"none"},"& .react-autosuggest__suggestion":{display:"block",marginBottom:0}}},e.createElement(a,{ref:se,renderInputComponent:ge,suggestions:X,onSuggestionsFetchRequested:be,onSuggestionsClearRequested:Ee,onSuggestionSelected:xe,renderSuggestionsContainer:he,getSuggestionValue:we,renderSuggestion:ve,inputProps:{placeholder:w,value:oe,onChange:ye,onFocus:me,onBlur:de,className:N}})):null};
//# sourceMappingURL=index.modern.js.map
