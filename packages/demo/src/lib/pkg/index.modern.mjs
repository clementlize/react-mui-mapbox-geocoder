import e,{useRef as t,useEffect as n,useState as r,useCallback as o}from"react";import a from"react-autosuggest";import l from"autosuggest-highlight/match";import s from"autosuggest-highlight/parse";import{Fade as i,LinearProgress as u,useTheme as c,Paper as p,alpha as g,Box as m,IconButton as f,MenuItem as h,Typography as d,InputBase as x,InputAdornment as b,TextField as E}from"@mui/material";import y from"@mui/icons-material/Search";import v from"@mui/icons-material/Cancel";import{useDebouncedCallback as w}from"use-debounce";function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e){return null!=e}const S=({show:t=!1})=>{const[o,a]=r(t),l=w(()=>a(!0),250);return n(()=>{t?l():(l.flush(),a(!1))},[l,t]),/*#__PURE__*/e.createElement(i,{in:o},/*#__PURE__*/e.createElement(u,{style:{position:"absolute",width:"100%"}}))},P=["ref","inputClasses"],j=t=>{let n=C({},t);/*#__PURE__*/return e.createElement(x,C({type:"search",fullWidth:!0,startAdornment:/*#__PURE__*/e.createElement(b,{position:"start"},/*#__PURE__*/e.createElement(y,{color:"action"}))},n))},I=t=>{let n=C({},t);/*#__PURE__*/return e.createElement(E,C({type:"search",fullWidth:!0,InputProps:{startAdornment:/*#__PURE__*/e.createElement(b,{position:"start"},/*#__PURE__*/e.createElement(y,{color:"action"}))}},n))};export default({endpoint:u="https://api.mapbox.com",inputPlaceholder:x="Search",showLoader:b=!0,source:E="mapbox.places",onSuggest:y=(()=>{}),focusOnMount:w=!1,showInputContainer:O=!0,inputValue:_="",proximity:R,country:$,bbox:T,types:q,limit:F,autocomplete:B,language:D,suggestionsPaperProps:W,onSelect:G,accessToken:V,onInputFocus:z,onInputBlur:A,inputClasses:H,inputProps:L,textFieldProps:U,inputPaperProps:M})=>{const[N,J]=r([]),[K,Q]=r(!1),[X,Y]=r(new Date),[Z,ee]=r(_),[te,ne]=r(!1),re=t(null),oe=function(e){const r=t();return n(()=>{r.current=e},[e]),r.current}(Z),ae=o(()=>{const{input:e=null}=re.current||{};e&&e.focus()},[]);n(()=>{ee(_)},[_]),n(()=>{w&&ae()},[w,ae]),n(()=>{y&&y(N)},[N,y]);const le=o(()=>{ee(""),ae()},[ae]),se=c(),ie=o(t=>{const{ref:n,inputClasses:r}=t,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}(t,P),a=C({},null!=M?M:{});let l=/*#__PURE__*/e.createElement(j,C({classes:r,inputRef:n},o,L));return U&&(l=/*#__PURE__*/e.createElement(I,C({classes:r,inputRef:n},o,U))),O?/*#__PURE__*/e.createElement(e.Fragment,null,/*#__PURE__*/e.createElement(S,{show:K&&b}),/*#__PURE__*/e.createElement(p,C({square:!1,elevation:1,sx:{paddingTop:1,paddingBottom:1,paddingRight:1,paddingLeft:2,backgroundColor:te?se.palette.background.paper:g(se.palette.background.paper,.9),overflow:"hidden","&:hover,&:active":{backgroundColor:se.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"}},a),/*#__PURE__*/e.createElement(m,{display:"flex",flexDirection:"row",alignItems:"center"},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexShrink:0,flexGrow:1}},l),/*#__PURE__*/e.createElement(i,{in:Z.length>0,unmountOnExit:!0,mountOnEnter:!0},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexGrow:0,flexShrink:1}},/*#__PURE__*/e.createElement(f,{"aria-label":"Clear Search Input",onClick:le,size:"large"},/*#__PURE__*/e.createElement(v,null))))))):l},[L,U,O,K,b,te,M,Z.length,le,se]),ue=o(e=>{ne(!0),z&&z(e)},[z]),ce=o(e=>{ne(!1),A&&A(e)},[A]),pe=o(t=>{const{containerProps:n,children:r}=t;/*#__PURE__*/return e.createElement(p,C({},n,{square:!1,elevation:4},W),r)},[W]),ge=o((e,t,n)=>{!e&&t&&t.features&&X<=n&&(Y(n),J(t.features.map(e=>({feature:e,label:e.place_name})).filter(e=>e.label)),Q(!1))},[X]),me=o(({value:e})=>{Q(!0),oe===e?Q(!1):""===e?(J([]),Q(!1)):async function(e,t,n,r,o,a,l,s,i,u,c,p){const g=new Date;try{const f=`${e}/geocoding/v5/${t}/${r}.json`,h=C({},k(n)&&{access_token:n},k(a)&&{proximity:a&&2===Object.keys(a).length?`${a.longitude},${a.latitude}`:null},k(s)&&{bbox:s&&s.length>0?s.join(","):null},k(i)&&{types:i},k(l)&&{country:l},k(u)&&{limit:u},k(c)&&{autocomplete:c},k(p)&&{language:p}),d=`${f}?${m=h,Object.keys(m).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(m[e])).join("&")}`,x=await fetch(d);return o(null,await x.json(),g),{err:null,res:x,searchTime:g}}catch(e){return o(e,null,g),{err:e,res:null,searchTime:g}}var m}(u,E,V,e,ge,R,$,T,q,F,B,D)},[T,$,u,F,D,B,E,R,oe,ge,q,V]),fe=o((e,{suggestion:t})=>(G&&G(t.feature),!1),[G]),he=o(()=>{J([])},[]),de=o((e,{newValue:t})=>{ee(t)},[]),xe=o((t,{query:n,isHighlighted:r})=>{const o=l(t.label,n),a=s(t.label,o);/*#__PURE__*/return e.createElement(h,{selected:r,component:"div"},/*#__PURE__*/e.createElement(d,{noWrap:!0,variant:"subtitle1"},a.map((t,n)=>/*#__PURE__*/e.createElement(d,{key:n,component:"span",variant:"inherit",sx:{fontWeight:t.highlight?500:300}},t.text))))},[]),be=o(e=>e.label,[]);return V?/*#__PURE__*/e.createElement(m,{sx:{"& .react-autosuggest__container":{flexGrow:1,position:"relative"},"& .react-autosuggest__suggestions-container--open":{position:"absolute",zIndex:1,marginTop:1,left:0,right:0},"& .react-autosuggest__suggestions-list":{margin:0,padding:0,listStyleType:"none"},"& .react-autosuggest__suggestion":{display:"block",marginBottom:0}}},/*#__PURE__*/e.createElement(a,{ref:re,renderInputComponent:ie,suggestions:N,onSuggestionsFetchRequested:me,onSuggestionsClearRequested:he,onSuggestionSelected:fe,renderSuggestionsContainer:pe,getSuggestionValue:be,renderSuggestion:xe,inputProps:{placeholder:x,value:Z,onChange:de,onFocus:ue,onBlur:ce,className:H}})):null};
//# sourceMappingURL=index.modern.mjs.map
