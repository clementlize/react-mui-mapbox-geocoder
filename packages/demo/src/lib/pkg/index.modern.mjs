import e,{useRef as t,useEffect as n,useState as r,useCallback as o}from"react";import a from"react-autosuggest";import l from"autosuggest-highlight/match";import s from"autosuggest-highlight/parse";import{Fade as i,LinearProgress as u,useTheme as c,Paper as p,alpha as g,Box as m,IconButton as f,MenuItem as h,Typography as d,InputBase as x,InputAdornment as b}from"@mui/material";import y from"@mui/icons-material/Search";import E from"@mui/icons-material/Cancel";import{useDebouncedCallback as v}from"use-debounce";function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e){return null!=e}const k=({show:t=!1})=>{const[o,a]=r(t),l=v(()=>a(!0),250);return n(()=>{t?l():(l.flush(),a(!1))},[l,t]),/*#__PURE__*/e.createElement(i,{in:o},/*#__PURE__*/e.createElement(u,{style:{position:"absolute",width:"100%"}}))},S=["ref","inputClasses"],j=t=>{let n=w({},t);/*#__PURE__*/return e.createElement(x,w({type:"search",fullWidth:!0,startAdornment:/*#__PURE__*/e.createElement(b,{position:"start"},/*#__PURE__*/e.createElement(y,{color:"action"}))},n))};export default({endpoint:u="https://api.mapbox.com",inputPlaceholder:x="Search",showLoader:b=!0,source:y="mapbox.places",onSuggest:v=(()=>{}),focusOnMount:O=!1,showInputContainer:_=!0,inputValue:I="",proximity:P,country:$,bbox:R,types:T,limit:q,autocomplete:B,language:D,suggestionsPaperProps:F,onSelect:G,accessToken:V,onInputFocus:W,onInputBlur:z,inputClasses:H,inputProps:L,inputPaperProps:U})=>{const[A,M]=r([]),[N,J]=r(!1),[K,Q]=r(new Date),[X,Y]=r(I),[Z,ee]=r(!1),te=t(null),ne=function(e){const r=t();return n(()=>{r.current=e},[e]),r.current}(X),re=o(()=>{const{input:e=null}=te.current||{};e&&e.focus()},[]);n(()=>{Y(I)},[I]),n(()=>{O&&re()},[O,re]),n(()=>{v&&v(A)},[A,v]);const oe=o(()=>{Y(""),re()},[re]),ae=c(),le=o(t=>{const{ref:n,inputClasses:r}=t,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}(t,S),a=w({},null!=U?U:{}),l=/*#__PURE__*/e.createElement(j,w({classes:r,inputRef:n},o,L));return _?/*#__PURE__*/e.createElement(e.Fragment,null,/*#__PURE__*/e.createElement(k,{show:N&&b}),/*#__PURE__*/e.createElement(p,w({square:!1,elevation:1,sx:{paddingTop:1,paddingBottom:1,paddingRight:1,paddingLeft:2,backgroundColor:Z?ae.palette.background.paper:g(ae.palette.background.paper,.9),overflow:"hidden","&:hover,&:active":{backgroundColor:ae.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"}},a),/*#__PURE__*/e.createElement(m,{display:"flex",flexDirection:"row",alignItems:"center"},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexShrink:0,flexGrow:1}},l),/*#__PURE__*/e.createElement(i,{in:X.length>0,unmountOnExit:!0,mountOnEnter:!0},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexGrow:0,flexShrink:1}},/*#__PURE__*/e.createElement(f,{"aria-label":"Clear Search Input",onClick:oe,size:"large"},/*#__PURE__*/e.createElement(E,null))))))):l},[L,_,N,b,Z,U,X.length,oe,ae]),se=o(e=>{ee(!0),W&&W(e)},[W]),ie=o(e=>{ee(!1),z&&z(e)},[z]),ue=o(t=>{const{containerProps:n,children:r}=t;/*#__PURE__*/return e.createElement(p,w({},n,{square:!1,elevation:4},F),r)},[F]),ce=o((e,t,n)=>{!e&&t&&t.features&&K<=n&&(Q(n),M(t.features.map(e=>({feature:e,label:e.place_name})).filter(e=>e.label)),J(!1))},[K]),pe=o(({value:e})=>{J(!0),ne===e?J(!1):""===e?(M([]),J(!1)):async function(e,t,n,r,o,a,l,s,i,u,c,p){const g=new Date;try{const f=`${e}/geocoding/v5/${t}/${r}.json`,h=w({},C(n)&&{access_token:n},C(a)&&{proximity:a&&2===Object.keys(a).length?`${a.longitude},${a.latitude}`:null},C(s)&&{bbox:s&&s.length>0?s.join(","):null},C(i)&&{types:i},C(l)&&{country:l},C(u)&&{limit:u},C(c)&&{autocomplete:c},C(p)&&{language:p}),d=`${f}?${m=h,Object.keys(m).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(m[e])).join("&")}`,x=await fetch(d);return o(null,await x.json(),g),{err:null,res:x,searchTime:g}}catch(e){return o(e,null,g),{err:e,res:null,searchTime:g}}var m}(u,y,V,e,ce,P,$,R,T,q,B,D)},[R,$,u,q,D,B,y,P,ne,ce,T,V]),ge=o((e,{suggestion:t})=>(G&&G(t.feature),!1),[G]),me=o(()=>{M([])},[]),fe=o((e,{newValue:t})=>{Y(t)},[]),he=o((t,{query:n,isHighlighted:r})=>{const o=l(t.label,n),a=s(t.label,o);/*#__PURE__*/return e.createElement(h,{selected:r,component:"div"},/*#__PURE__*/e.createElement(d,{noWrap:!0,variant:"subtitle1"},a.map((t,n)=>/*#__PURE__*/e.createElement(d,{key:n,component:"span",variant:"inherit",sx:{fontWeight:t.highlight?500:300}},t.text))))},[]),de=o(e=>e.label,[]);return V?/*#__PURE__*/e.createElement(m,{sx:{"& .react-autosuggest__container":{flexGrow:1,position:"relative"},"& .react-autosuggest__suggestions-container--open":{position:"absolute",zIndex:1,marginTop:1,left:0,right:0},"& .react-autosuggest__suggestions-list":{margin:0,padding:0,listStyleType:"none"},"& .react-autosuggest__suggestion":{display:"block",marginBottom:0}}},/*#__PURE__*/e.createElement(a,{ref:te,renderInputComponent:le,suggestions:A,onSuggestionsFetchRequested:pe,onSuggestionsClearRequested:me,onSuggestionSelected:ge,renderSuggestionsContainer:ue,getSuggestionValue:de,renderSuggestion:he,inputProps:{placeholder:x,value:X,onChange:fe,onFocus:se,onBlur:ie,className:H}})):null};
//# sourceMappingURL=index.modern.mjs.map
